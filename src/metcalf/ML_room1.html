<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Weekly Calendar</title>
    <link href="../style.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div class="header" id="header">
    <h1>
        <div class="dropdown">
            <button onclick="myFunction()" class="dropbtn">Dorms</button>
            <div id="myDropdown" class="dropdown-content">
                <a href="#">Echols-Humphreys</a>
                <a href="#">Emmett-Page</a>
                <a href="../metcalf/ML_index.html">Metcalf-Lefevre</a>
            </div>
        </div>
        <strong><a href="../mainPages/homepage.html" style="text-decoration: none; color: #0288d1">STAZE</a></strong>
        find your next study spot
    </h1>
</div>
<header>
    <h2>
        <strong>Metcalf-Lefevre</strong><br>
        Room 1
        <div>
            <a href="https://script.google.com/macros/s/AKfycbxvQimB0qHOyz33jlPfIEd4GWwbndLxh4QCYCPwSQeh6Z_Svndm6XstFYbAao759EaX/exec" target="_blank">
                <button class="booking">BOOK</button>
            </a>
        </div>
    </h2>

</header>

<div class="calendar">
    <div class="calendar-header" id="calendar-header"></div>
    <script>
        function getWeek() {
            let currentDate = new Date();
            let dayOfWeek = currentDate.getDay();


            let daysToSubtract = dayOfWeek;
            currentDate.setDate(currentDate.getDate() - daysToSubtract);


            let startDate = currentDate.toLocaleDateString('en-US', { weekday: 'long', month: 'short', day: 'numeric', year: 'numeric' });
            document.getElementById("calendar-header").textContent = "Week of " + startDate;
        }


        function updateDates() {
            const days = document.querySelectorAll('.day:not(.time-column) p');


            let currentDate = new Date();
            let dayOfWeek = currentDate.getDay();


            let daysToSubtract = dayOfWeek;
            currentDate.setDate(currentDate.getDate() - daysToSubtract);


            for (let i = 0; i < days.length; i++) {
                days[i].textContent = currentDate.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
                currentDate.setDate(currentDate.getDate() + 1);
            }
        }


        function generateTimeSlots() {
            const timeColumn = document.querySelector('.time-column .day-booking');
            timeColumn.innerHTML = '';


            for (let i = 0; i < 24; i++) {
                const hourBlock = document.createElement('div');
                hourBlock.classList.add('hour');


                let hour;
                let period;


                if (i == 0) {
                    hour = 12;
                    period = 'AM';
                } else if (i < 12) {
                    hour = i;
                    period = 'AM';
                } else if (i == 12) {
                    hour = 12;
                    period = 'PM';
                } else {
                    hour = i - 12;
                    period = 'PM';
                }


                hourBlock.textContent = `${hour}:00 ${period}`;
                timeColumn.appendChild(hourBlock);
            }
        }


        function generateEmptySlots() {
            const days = document.querySelectorAll('.day:not(.time-column) .day-booking');
            days.forEach(column => {
                column.innerHTML = '';
                for (let i = 0; i < 24; i++) {
                    const emptyBlock = document.createElement('div');
                    emptyBlock.classList.add('hour');
                    column.appendChild(emptyBlock);
                }
            });
        }


        window.onload = function() {
            getWeek();
            updateDates();
            generateTimeSlots();
            generateEmptySlots();
        };

    </script>

    <div class="calendar-days">
        <div class="day time-column">
            <span>Time</span>
            <p style ="visibility: hidden;">Placeholder</p>
            <div class ="day-booking"></div>
        </div>


        <div class="day">
            <span>Sun</span>
            <p></p>
            <div class="day-booking"></div>
        </div>
        <div class="day">
            <span>Mon</span>
            <p></p>
            <div class="day-booking"></div>
        </div>
        <div class="day">
            <span>Tue</span>
            <p></p>
            <div class="day-booking"></div>
        </div>
        <div class="day">
            <span>Wed</span>
            <p></p>
            <div class="day-booking"></div>
        </div>
        <div class="day">
            <span>Thu</span>
            <p></p>
            <div class="day-booking"></div>
        </div>
        <div class="day">
            <span>Fri</span>
            <p></p>
            <div class="day-booking"></div>
        </div>
        <div class="day">
            <span>Sat</span>
            <p></p>
            <div class="day-booking"></div>
        </div>
    </div>

</div>

    <footer>
    <p>staze</p>
</footer>

<script>
    /* When the user clicks on the button,
    toggle between hiding and showing the dropdown content */
    function myFunction() {
        document.getElementById("myDropdown").classList.toggle("show");
    }

    // Close the dropdown if the user clicks outside of it
    window.onclick = function(event) {
        if (!event.target.matches('.dropbtn')) {
            var dropdowns = document.getElementsByClassName("dropdown-content");
            var i;
            for (i = 0; i < dropdowns.length; i++) {
                var openDropdown = dropdowns[i];
                if (openDropdown.classList.contains('show')) {
                    openDropdown.classList.remove('show');
                }
            }
        }
    }
</script>
</body>
</html>
